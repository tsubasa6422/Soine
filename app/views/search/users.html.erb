<div class="container mt-4">
  <div class="card shadow-sm mb-3">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center">
        <h4 class="mb-0">ユーザー検索</h4>
        <div class="d-flex gap-2">
          <%= link_to "投稿検索へ", search_path, class: "btn btn-outline-secondary btn-sm" %>
        </div>
      </div>

      <hr>

      <%= form_with url: search_users_path, method: :get, local: true do |f| %>
        <div class="row g-2 align-items-center">
          <div class="col-md-8">
            <%= f.text_field :q, value: params[:q], class: "form-control", placeholder: "ユーザー名で検索" %>
          </div>

          <div class="col-md-3">
            <%= f.select :sort,
                         [["新しい順", "new"], ["古い順", "old"]],
                         { selected: params[:sort].presence || "new" },
                         class: "form-select" %>
          </div>

          <div class="col-md-1 d-grid">
            <%= f.submit "検索", class: "btn btn-primary" %>
          </div>
        </div>

        <div class="mt-2">
          <%= link_to "クリア", search_users_path, class: "btn btn-outline-secondary btn-sm" %>
        </div>
      <% end %>

      <% if params[:q].present? %>
        <div class="text-muted small mt-2">
          「<%= params[:q] %>」の検索結果：<%= @users.size %> 件
        </div>
      <% end %>
    </div>
  </div>

    <% @users.each do |user| %>
      <%= link_to user_path(user), class: "text-decoration-none text-dark" do %>
        <div class="card shadow-sm mb-2">
          <div class="card-body d-flex align-items-center gap-3">

            <!-- アイコン -->
            <div class="rounded-circle bg-secondary text-white d-flex align-items-center justify-content-center"
                style="width: 40px; height: 40px; font-weight: bold;">
              <%= (user.name.presence || "U").first.upcase %>
            </div>

            <!-- ユーザー情報 -->
            <div>
              <strong><%= user.name.presence || "ユーザー" %></strong>
              <div class="text-muted small">
                <%= user.created_at.strftime("%Y/%m/%d") %> 登録
              </div>
            </div>

          </div>
        </div>
      <% end %>
    <% end %>


  <% if params[:q].present? && @users.empty? %>
    <div class="text-muted">該当するユーザーはいませんでした。</div>
  <% end %>
</div>
